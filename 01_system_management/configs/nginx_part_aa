# Optimized nginx Configuration for MCP Server
# File: /etc/nginx/nginx.conf

# Main context
user www-data;
worker_processes auto;
worker_rlimit_nofile 65535;
pid /run/nginx.pid;

# Include module configurations
include /etc/nginx/modules-enabled/*.conf;

events {
    # Performance optimization
    worker_connections 8192;
    multi_accept on;
    use epoll;
    
    # Connection processing
    accept_mutex off;
    accept_mutex_delay 500ms;
}

http {
    # Basic Settings
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    keepalive_requests 1000;
    types_hash_max_size 2048;
    server_tokens off;
    
    # File and MIME type handling
    include /etc/nginx/mime.types;
    default_type application/octet-stream;
    
    # Character encoding
    charset utf-8;
    source_charset utf-8;
    
    # Request size limits
    client_max_body_size 16M;
    client_body_buffer_size 128k;
    client_header_buffer_size 1k;
    large_client_header_buffers 4 16k;
    
    # Timeout settings
    client_body_timeout 12;
    client_header_timeout 12;
